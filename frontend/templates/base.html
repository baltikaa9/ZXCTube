<!DOCTYPE html>
<html lang="en" style="font-size: 15px; font-family: Roboto, Arial, sans-serif;">
<head>
  <meta charset="UTF-8">
  {% block head %} {% endblock %}
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', path='/css/bootstrap.css') }}">
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', path='/css/fontello.css') }}">
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', path='/css/style.css') }}">
  <link rel="icon" type="image/x-icon" href="{{ url_for('static', path='/img/zxc.ico') }}">
</head>
<body>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <div id="g_id_onload"
     data-client_id="997307486852-nrh7de9jt8bg15agf6sd086v8ji016qi.apps.googleusercontent.com"
     data-context="signin"
     data-ux_mode="popup"
     data-callback="login"
     data-auto_prompt="false"
  >
  </div>


  <header>
    <div class="container">
      <div class="row">
        <div class="col-6 logo">
          <a href="/" title="Главная страница ZXCTube"><img src="{{ url_for('static', path='/img/logo.png') }}" alt="" width="100px">Tube</a>
        </div>
        <div id="my-profile" class="col-6 pt-3 d-md-flex justify-content-md-end">
            <div class="g_id_signin"
               data-type="standard"
               data-shape="pill"
               data-theme="filled_black"
               data-text="signin_with"
               data-size="large"
               data-logo_alignment="left"
               style="margin-left: -30px">
            </div>
        </div>
      </div>
    </div>
  </header>


  <div id="content">
    {% block content %} {% endblock %}
  </div>

  <script src="{{ url_for('static', path='/js/bootstrap.bundle.js') }}"></script>
  <script src="{{ url_for('static', path='/js/script.js') }}"></script>
  <script>
    document.addEventListener('DOMContentLoaded', async function() {
        const token = getToken();
        let myProfile = document.getElementById('my-profile');
        if (token) {
            const response = await fetch('/api/user/me', {
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            });
            let me = await response.json();
            let myProfileLink = document.createElement('a');
            myProfileLink.href = `http://localhost:8000/${me.id}`;
            myProfileLink.className = 'user-link'
            let myProfilePic = document.createElement('img');
            myProfilePic.className = 'user-pic';
            myProfilePic.src = me.picture;
            myProfilePic.width = 40;
            myProfilePic.alt = '';
            myProfileLink.appendChild(myProfilePic);
            myProfile.innerHTML = '';
            myProfile.appendChild(myProfileLink);

            let logoutButton = document.createElement('button');
            logoutButton.className = 'btn btn-dark btn-sm btn-logout';
            logoutButton.textContent = 'Выйти';
            logoutButton.onclick = (() => logout());
            myProfile.appendChild(logoutButton)
        }
    });
  </script>
  {% block script %} {% endblock %}
</body>
</html>